# セクションロック設計

## Q: Markdownでセクションロックを実現するには？

## A: h2見出し単位でロック

- ロック単位: h2〜次のh2までを1セクション
- 識別方式: 位置ベース（`h2[0]`, `h2[1]`...）+ ハッシュ補正
- 通信: SSEでリアルタイム同期
- 構造変更時: ハッシュで追跡、見つからなければロック解放

## 補足: SSE + Cloudflare

- Cloudflare Tunnel/WAF経由ではタイムアウトで切断される可能性あり
- サーバーから15〜30秒間隔でHeartbeat送信が必須
